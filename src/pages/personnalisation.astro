---
import Layout from "../layouts/Layout.astro";
---

<Layout title="Personnalisation - TaVue">
    <h1 class="main-title">PERSONNALISATION</h1>

    <div class="configurator-row">
        <!-- Colonne gauche : preview + nom + bouton -->
        <div class="preview-block">
            <div class="preview-svg">
                <svg
                    id="svg-lunettes"
                    xmlns="http://www.w3.org/2000/svg"
                    viewBox="0 0 595.28 350"
                    width="390"
                    height="190"
                >
                    <g id="branches">
                        <path
                            id="branch1"
                            class="cls-4"
                            d="M108.83,155.14s49.35-5.57,54.93-8.76,11.14-7.96,19.5-9.55,64.48-11.14,64.48-11.14c0,0,7.16-1.99,17.51,5.57s33.04,31.84,39.4,31.05c6.37-.8,9.55-9.55,7.56-13.53s-40.67-32.75-47.36-34.63c-9.53-2.68-21.89-2.39-37.02,0-15.12,2.39-116.22,23.34-116.22,23.34,0,0-13.13,6.12-2.79,17.66Z"
                        ></path>
                        <path
                            id="branch2"
                            class="cls-1"
                            d="M308.24,150.76s-.31,6.15-3.98,5.57c-4.97-.78-35.82-33.83-46.17-32.24,0,0,8.53,2.71,18.46,11.64,6.51,5.86,34.42,37.85,31.69,15.03Z"
                        ></path>
                        <path
                            id="branch3"
                            class="cls-4"
                            d="M374.79,179.65l90.54-29.78s22.13-5.63,25.35-4.02,17.71,30.58,17.71,33.8-2.42,14.01-5.63,14.89c-2.33.64-5.33.11-6.84-4.21-1.41-4.02-6.84-31.73-12.47-31.47s-50.7,15.95-50.7,15.95c0,0-13.28,6.44-18.91,11.27s-32.19,11.27-32.19,11.27c0,0-9.66-7.65-6.84-17.71Z"
                        ></path>
                        <path
                            id="branch4"
                            class="cls-1"
                            d="M381.34,180.1s102.27-35.19,107.85-31.99c0,0-18.2,2.49-41.76,11.88s-66.09,22.03-66.09,22.03v-1.92Z"
                        ></path>
                        <path
                            id="branch5"
                            class="cls-1"
                            d="M485.36,158.06s3.26,0,4.98,3.45,9.77,24.71,9.77,24.71c0,0,.77,4.98,5.17-2.68,0,0-3.07,9.56-5.36,6.79s-9.77-26.33-9.77-26.33c0,0-2.87-6.74-4.79-5.94Z"
                        ></path>
                    </g>
                    <g id="monture">
                        <path
                            id="monture-main"
                            class="cls-4"
                            d="M385.31,180.81c-.24-3.41-9.57-5.22-12.71-6.4-3.14-1.18-15.7,1.96-15.7,1.96-12.17-3.14-54.55-9.03-78.88-9.03s-32.57,11.38-35.32,10.99c-2.75-.39-17.27-.78-23.55-1.96-6.28-1.18-5.1-14.13-39.25-26.48-34.14-12.35-68.29-12.42-68.29-12.42-13.35,4.66-6.76,18.49-6.76,18.49l2.05,6.35c4.32,2.03,3.14,10.52,4.71,23.08s7.46,28.65,14.13,38.46c6.67,9.81,31.79,20.8,44.35,21.19s23.55-1.96,31.79-15.31c8.24-13.34,16.88-36.89,16.88-36.89l10.2,1.57s2.91.31,5.35,3.09,4.43,8.03,7.6,17.31c7.56,22.1,25.12,39.25,25.12,39.25,0,0,5.6,7.43,33.44,12.66,23.08,4.34,42.7-2.46,42.7-2.46,17.72-7.17,21.63-44.96,21.63-44.96,0,0,1.83-13.3,7.81-16.65,7.37-4.14,8.27-4.44,12.71-5.32,3.61-.71.24-13.13,0-16.54Z"
                        ></path>
                    </g>
                    <g id="verres">
                        <path
                            id="verreG"
                            class="cls-5"
                            d="M116.32,162.87c-.88,6.05.4,37.41,11.44,55.31s37.04,21.35,41.37,21.31,18.51,1.02,24.47-9.27c4.97-8.59,13.17-43.48,9.12-53.05-6.26-14.82-40.4-24.02-40.4-24.02,0,0-26.85-5.46-33.82-4.46,0,0-9.97-.96-12.17,14.17Z"
                        ></path>
                        <path
                            id="verreD"
                            class="cls-5"
                            d="M247.32,192.54s-1.09-9.55,19.57-16.69c11.76-4.06,60.46,3.23,60.46,3.23,0,0,19.09,4.06,21.71,8.28,2.62,4.22,9.46,17.24,8.29,37.97-1.14,20.21-7.31,26.8-12.61,30.31,0,0-7.1,4.93-21.34,5.93-26.65,1.88-37.01-1.14-46.19-7.73-29.88-21.46-29.88-61.3-29.88-61.3Z"
                        ></path>
                    </g>
                </svg>
            </div>
            <label class="input-label" for="nom-modele">NOM DU MODÈLE</label>
            <input id="nom-modele" class="input-box" placeholder="MaTulwa" />
            <button class="save-btn">
                <span class="btn-check">✓</span>
                SAUVEGARDER
            </button>
        </div>

        <!-- Colonne droite : étapes -->
        <div class="steps-block">
            <!-- Étape 1 -->
            <div class="step-section">
                <div class="step-label">ÉTAPE 1/4 : MATÉRIAU</div>
                <div class="step-grid step-grid-4" id="mat-step">
                    <button class="step-btn selected" data-val="Normal"
                        >Normal</button
                    >
                    <button class="step-btn" data-val="Bois">Bois</button>
                    <button class="step-btn" data-val="Titan">Titan</button>
                    <button class="step-btn" data-val="Plastique transparent"
                        >Plastique transparent</button
                    >
                </div>
            </div>
            <!-- Étape 2 -->
            <div class="step-section">
                <div class="step-label">ÉTAPE 2/4 : TYPE DE VERRES</div>
                <div class="step-grid step-grid-1" id="verre-step">
                    <button class="step-btn selected" data-val="Optique"
                        >Optique</button
                    >
                    <button class="step-btn" data-val="Solaire">Solaire</button>
                    <button class="step-btn" data-val="Anti-lumière bleue"
                        >Anti-lumière bleue</button
                    >
                </div>
            </div>
            <!-- Étape 3-->
            <div class="step-section">
                <div class="step-label">ÉTAPE 3/4 : COULEUR MONTURE</div>
                <div class="color-grid" id="grid-monture">
                    <button
                        class="color-btn selected"
                        style="background:#111"
                        data-color="#111"></button>
                    <button
                        class="color-btn"
                        style="background:#494949"
                        data-color="#494949"></button>
                    <button
                        class="color-btn"
                        style="background:#7a5332"
                        data-color="#7a5332"></button>
                    <button
                        class="color-btn"
                        style="background:#cea87c"
                        data-color="#cea87c"></button>
                    <button
                        class="color-btn"
                        style="background:#dadada"
                        data-color="#dadada"></button>
                    <button
                        class="color-btn"
                        style="background:#f6f6f6"
                        data-color="#f6f6f6"></button>
                </div>
            </div>
            <!-- Étape 4-->
            <div class="step-section">
                <div class="step-label">ÉTAPE 4/4 : COULEUR BRANCHE</div>
                <div class="color-grid" id="grid-branche">
                    <button
                        class="color-btn selected"
                        style="background:#111"
                        data-color="#111"></button>
                    <button
                        class="color-btn"
                        style="background:#494949"
                        data-color="#494949"></button>
                    <button
                        class="color-btn"
                        style="background:#7a5332"
                        data-color="#7a5332"></button>
                    <button
                        class="color-btn"
                        style="background:#cea87c"
                        data-color="#cea87c"></button>
                    <button
                        class="color-btn"
                        style="background:#dadada"
                        data-color="#dadada"></button>
                    <button
                        class="color-btn"
                        style="background:#f6f6f6"
                        data-color="#f6f6f6"></button>
                </div>
            </div>
            <!-- Étape 5: couleur verres -->
            <div class="step-section">
                <div class="step-label">COULEUR DES VERRES</div>
                <div class="color-grid" id="grid-verre">
                    <button
                        class="color-btn selected"
                        style="background:#e0e7ff"
                        data-color="#e0e7ff"
                        data-opacity="0.5"></button>
                    <button
                        class="color-btn"
                        style="background:#93c5fd"
                        data-color="#93c5fd"
                        data-opacity="0.5"></button>
                    <button
                        class="color-btn"
                        style="background:#f6f6f6"
                        data-color="#f6f6f6"
                        data-opacity="0.3"></button>
                    <button
                        class="color-btn"
                        style="background:#e5e7eb"
                        data-color="#e5e7eb"
                        data-opacity="0.45"></button>
                    <button
                        class="color-btn"
                        style="background:#e1e3e7"
                        data-color="#e1e3e7"
                        data-opacity="0.5"></button>
                    <button
                        class="color-btn"
                        style="background:#fbbf24"
                        data-color="#fbbf24"
                        data-opacity="0.3"></button>
                </div>
            </div>
        </div>
    </div>
    <style>
        body {
            background: #232537;
            font-family: "Plus Jakarta Sans", sans-serif;
        }
        .main-title {
            text-align: center;
            color: #cbd4e6;
            font-size: 4vw;
            font-weight: 900;
            letter-spacing: 0.13em;
            margin-top: 2em;
            margin-bottom: 1em;
        }
        .configurator-row {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            flex-direction: row;
            gap: 3em;
            justify-content: center;
            align-items: flex-start;
        }
        .preview-block {
            flex: 0.7;
            min-width: 370px;
            display: flex;
            flex-direction: column;
            gap: 0.7em;
        }
        .preview-svg {
            background: linear-gradient(to bottom, #e8eef7, #f8fafd);
            border-radius: 12px;
            border: 1.5px solid #d8e0ed;
            box-shadow: 0 2px 16px 0 #cbd4e6;
            display: flex;
            align-items: center;
            justify-content: center;
            min-height: 270px;
            margin-bottom: 1em;
        }
        .input-label {
            color: #cbd4e6;
            font-size: 0.92em;
            font-weight: 700;
            letter-spacing: 0.11em;
            margin-left: 1px;
            margin-bottom: 0.3em;
            text-transform: uppercase;
        }
        .input-box {
            padding: 0.7em 0.8em;
            border-radius: 6px;
            border: 1.5px solid #d8e0ed;
            background: #232537;
            font-size: 1em;
            margin-bottom: 0.9em;
            color: #fff;
            box-shadow: 0 1px 6px 0 #232537;
            width: 100%;
            max-width: 410px;
        }
        .save-btn {
            padding: 1em 0;
            background: linear-gradient(90deg, #2563eb, #3b82f6);
            color: #fff;
            border-radius: 5px;
            font-size: 1em;
            font-weight: 700;
            letter-spacing: 0.09em;
            border: none;
            width: 100%;
            max-width: 410px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 9px;
            box-shadow: 0 4px 18px rgba(37, 99, 235, 0.08);
            cursor: pointer;
        }
        .btn-check {
            font-size: 1.1em;
        }
        .steps-block {
            flex: 1.2;
            min-width: 370px;
            display: flex;
            flex-direction: column;
            gap: 2.2em;
        }
        .step-section {
            margin-bottom: 0.2em;
        }
        .step-label {
            font-size: 0.87em;
            color: #cbd4e6;
            font-weight: 800;
            letter-spacing: 0.13em;
            text-transform: uppercase;
            margin-bottom: 0.7em;
        }
        .step-grid {
            display: grid;
            gap: 0.7em;
        }
        .step-grid-4 {
            grid-template-columns: repeat(2, 1fr);
        }
        .step-grid-1 {
            grid-template-columns: 1fr;
        }
        .step-btn {
            background: #fff;
            color: #232537;
            border: 1.5px solid #d8e0ed;
            border-radius: 7px;
            font-size: 1em;
            padding: 0.82em 1.25em;
            font-weight: 600;
            cursor: pointer;
            outline: none;
            box-shadow: 0 2px 8px #eaebec;
            transition:
                border 0.16s,
                box-shadow 0.15s;
            text-align: left;
        }
        .step-btn.selected,
        .step-btn:focus {
            border: 2px solid #2563eb;
            background: #eaf3fe;
            box-shadow: 0 4px 14px #2563eb44;
            color: #2563eb;
            z-index: 1;
        }
        .color-grid {
            display: grid;
            grid-template-columns: repeat(3, 80px);
            grid-template-rows: repeat(2, 80px);
            gap: 1em;
        }
        .color-btn {
            width: 80px;
            height: 80px;
            border-radius: 13px;
            border: 2.5px solid #eee;
            box-shadow: 0 2px 8px #e5e6ea;
            cursor: pointer;
            transition:
                border 0.18s,
                box-shadow 0.18s,
                transform 0.13s;
            outline: none;
        }
        .color-btn.selected,
        .color-btn:focus {
            border: 2.5px solid #2563eb;
            box-shadow: 0 4px 13px #2563eb77;
            transform: scale(1.09);
        }
        @media (max-width: 950px) {
            .configurator-row {
                flex-direction: column;
                gap: 2em;
            }
            .preview-block,
            .steps-block {
                min-width: 100%;
            }
        }
        @media (max-width: 650px) {
            .main-title {
                font-size: 2em;
            }
            .color-grid .color-btn {
                width: 48px;
                height: 48px;
            }
        }
    </style>
    <script>
        // Un seul bouton sélectionné par step
        document.querySelectorAll(".step-grid").forEach((grid) => {
            grid.querySelectorAll(".step-btn").forEach((btn) => {
                btn.addEventListener("click", function () {
                    grid.querySelectorAll(".step-btn").forEach((b) =>
                        b.classList.remove("selected"),
                    );
                    btn.classList.add("selected");
                });
            });
        });
        // Couleur monture
        document.querySelectorAll("#grid-monture .color-btn").forEach((btn) => {
            btn.addEventListener("click", function () {
                document
                    .querySelectorAll("#grid-monture .color-btn")
                    .forEach((b) => b.classList.remove("selected"));
                btn.classList.add("selected");
                document
                    .getElementById("monture-main")
                    .setAttribute("fill", btn.dataset.color);
            });
        });
        // Couleur branches
        document.querySelectorAll("#grid-branche .color-btn").forEach((btn) => {
            btn.addEventListener("click", function () {
                document
                    .querySelectorAll("#grid-branche .color-btn")
                    .forEach((b) => b.classList.remove("selected"));
                btn.classList.add("selected");
                ["branch1", "branch2", "branch3", "branch4", "branch5"].forEach(
                    function (id) {
                        var elem = document.getElementById(id);
                        if (elem) elem.setAttribute("fill", btn.dataset.color);
                    },
                );
            });
        });
        // Couleur verres
        document.querySelectorAll("#grid-verre .color-btn").forEach((btn) => {
            btn.addEventListener("click", function () {
                document
                    .querySelectorAll("#grid-verre .color-btn")
                    .forEach((b) => b.classList.remove("selected"));
                btn.classList.add("selected");
                document
                    .getElementById("verreG")
                    .setAttribute("fill", btn.dataset.color);
                document
                    .getElementById("verreG")
                    .setAttribute("opacity", btn.dataset.opacity);
                document
                    .getElementById("verreD")
                    .setAttribute("fill", btn.dataset.color);
                document
                    .getElementById("verreD")
                    .setAttribute("opacity", btn.dataset.opacity);
            });
        });
    </script>
</Layout>
